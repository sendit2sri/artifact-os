# E2E override: run web in production mode (pre-built image, next start only).
# Use: docker compose -f docker-compose.yml -f docker-compose.e2e.yml up -d ...
# Build first: make e2e-rebuild
#
# Flow: make e2e-rebuild → make e2e-up → make e2e-smoke

services:
  web:
    build:
      context: ./apps/web
      dockerfile: Dockerfile
      target: runner
      args:
        NEXT_PUBLIC_API_URL: /api/v1
        NEXT_PUBLIC_E2E_MODE: "true"
        NEXT_PUBLIC_ENABLE_TEST_SEED: "true"
    command: ["npm", "run", "start", "--", "-H", "0.0.0.0", "-p", "3000"]
    volumes: []
